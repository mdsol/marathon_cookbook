#!/bin/bash
# This file is generated by Chef

<%- if @syslog -%>
# stdout and stderr to syslog
exec 1> >(exec logger -p user.info -t "marathon")
exec 2> >(exec logger -p user.err  -t "marathon")
<%- end -%>

# set LIBPROCESS_IP
# https://github.com/mesosphere/marathon/issues/1198
export LIBPROCESS_IP=<%= node['ipaddress'] %>

# marathon jar configuration
exec java \
<%- @jvm.sort.each do |option, value| -%>
<%- if value -%>
  <%= "-#{option}" %><%= "=#{value}" if value.is_a? String %> \
<%- end -%>
<%- end -%>
-jar <%= @jar %> \
<%- @flags.sort.each do |flag, value| -%>
<%- if value.is_a? String -%>
  <%= "--#{flag}" %><%= " \"#{value}\"" %> \
<%- else -%>
  <%= "--#{value ? '' : 'disable_'}#{flag}" %> \
<%- end -%> 
<%- end -%>
